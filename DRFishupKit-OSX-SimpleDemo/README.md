#Простой пример DRFishupKit для Mac OSX

Подробнее о DRFishupKit читайте в файле [DRFishupKit.pages](https://github.com/picasso/DRFishupKit/blob/master/DRFishupKit.pages).

---
###Первые шагиДля того, чтобы использовать в своем проекте DRFishupKit вам необходимо создать объект класса DRFishupEngine, через который вы будете осуществлять все операции по взаимодействию с Fishup API. Я предпочитаю сохранять этот объект в свойстве либо класса реализуещего `Application Delegate`, либо в свойстве класса реализующего `Window Controller`. Затем вам необходимо задать блок для обработчика ошибок (если он вам нужен) и блок для индикации сетевой активности (опять же, если это требуется).

```objectivec
self.engine = [[DRFishupEngine alloc] init];[self.engine onError:^(NSError *error) {      if(error.code == 16000) { // Данный метод требует дополнительных параметров        [[NSAlert alertWithError:error] runModal];    }    else        NSLog(@"Произошла ошибка:%@", error);}];[self.engine onNetworked:^{        if(self.engine.isNetworkActive)        [self.networkActivity startAnimation:self];    else        [self.networkActivity stopAnimation:self];}];
```

###Пример 1. Получение информации о пользователеСчитаем что объект  класса DRFishupEngine у нас уже создан и обработчик ошибок для него установлен. Чтобы получить публичную информацию о пользователе Fishup нужно вызвать метод `accounts.user.getPublicData` и передать в качестве параметра ID пользователя о котором мы хотим получить данные. В данном примере данные полученные от Fishup выводятся в в `NSTextView`.```objectivec[self.engine sendAPI:@"accounts.user.getPublicData"          withParams:[NSDictionary dictionaryWithObject:kUserID forKey:@"id"]        onCompletion:^(NSDictionary *data) {        [self.fishupResponse setString:[data description]];}];```###Пример 2. Получение списка популярных фотографийТеперь воспользуемся словарем `ApiHelper` для получения списка популярных фотографий за определенный период. В словаре есть ключи для запросов с периодом на год, месяц и неделю. Необходимо указать только ключ словаря (в данном случае это будет ключ "**top**" и ключ следующего уровня "**year**") и все. Название метода и необходимые параметры будут взяты из словаря.```objectivec[self.engine sendAPI:@"top.year" onCompletion:^(NSArray *data) {        [self.fishupResponse setString:[data description]];}];
```###Пример 3. Получение списка альбомов для своего аккаунтаДля получения списка своих альбомов необходимо сначала авторизоваться и получить `token`. Cделаем это синхронным методом с ожиданием ответа от сервера. И при удачной авторизации запросим список альбомов. Чтобы продемонстрировать возможные преобразования полученных данных с помощью **KVC**, возьмем из структуры только ссылки на изображения вида *square* (маленькие квадратные превьюшки). 

```objectivecBOOL isLoginOk = [self.engine login:kFishupMyLogin password:kFishupMyPassword andWait:YES];if(isLoginOk) {    [self.engine sendAPI:@"my.albums" onCompletion:^(NSArray *data) {                NSArray *squareURLs = [data valueForKeyPath:@"photo.square.url"];        [self.fishupResponse setString:[squareURLs description]];    }];}
```###Пример 4. Загрузка фотографий в новый альбомПодробно про технологию загрузки файлов на Fishup описано в [DRFishupKit.pages](https://github.com/picasso/DRFishupKit/blob/master/DRFishupKit.pages). Данный пример лишь демонстрирует описанные шаги: добавление списка файлов в очередь загрузки, задание дополнительных атрибутов для этих файлов, задание блока для отображения прогресс-индикатора загрузки и старт процесса с указанием ID альбома.```objectivec[self.engine addUploads:urls];int i =0;for(NSURL *url in urls) {        DRUploadFile *file = [self.engine uploadForPath:[url path]];        file.title = [NSString stringWithFormat:@"Myfile#%d", (i++ +1)];    file.author = @"Dmitry Rudakov";    file.desc = @"Apple has been busy updating Mac OS X to version 10.8";    file.tags = [NSString stringWithFormat:@"tag%d, tag%d, tag%d", i+1, i+2, i+3];}[self.engine onProgress:^(double progress) {        [self.uploadProgress setDoubleValue:progress];}];[self.engine uploadToGallery:kFishupMyGalleryID onCompletion:^(NSArray *list) {        NSLog(@"upload of %ld of %ld files completed\n", [list count], [urls count]);    for(DRUploadFile *file in list)        NSLog(@"%@ (id=%@)\n", file.title, file.fileid);}];```
